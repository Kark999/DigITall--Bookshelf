import{r as n,i as M,a as $,b as q,c as i,d as b,e as f,f as _,g as D,s as C,h as W,j as z}from"./assets/showHideFn-dfc5ae5c.js";import{a as E,b as R,i as N}from"./assets/vendor-4a53a031.js";E.defaults.baseURL="https://books-backend.p.goit.global/books";const d={list:"/category-list",topbooks:"/top-books",category:"/category?category=",id:"/{id}"};async function l(t,e=""){try{const o=t+e;return(await E.get(o)).data}catch(o){return console.error("Error fetching data:",o),null}}function w(t,e){const o=JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):[];if(t.target.textContent.toLowerCase().includes("add"))o.push(e),localStorage.setItem("cart",JSON.stringify(o));else{const a=o.findIndex(s=>s._id===e._id);o.splice(a,1),localStorage.setItem("cart",JSON.stringify(o))}}function L(t){const e=O();return e?e.some(o=>o._id===t._id):!1}function O(){return JSON.parse(localStorage.getItem("cart"))||[]}const m="Add to shopping list",u="Remove from the shopping list",x='Congratulations! You have added the book to the shopping list. To delete, press the button "Remove from the shopping list".',T="",F="No description has been added to this book";let p;async function j(t){const e=t.target.dataset.id,o=await l(e);return p=o,`<div class="modal-container">
        <button class="modal-button-close" type="button">
        <svg class="modal-icon-close" width="24" height="24">
        <use href=${M}#x-close></use></svg></button>
        <div class="modal-book-wrapper">
        <img
          class="modal-img"
          src="${o.book_image}"
          alt="${o.title}"
          width="287"
          height="408"/>
        <div class="modal-book-desc-wrapper">
        <h2 class="modal-book-title">${o.title}</h2>
        <h3 class="modal-book-author">${o.author}</h3>
        <p class="modal-book-desc">${o.description?o.description:F}</p>
        <div class="modal-buy-links-wrapper">
        <a
          class="modal-buy-link"
          href=${o.buy_links[0].url}
          target="_blank">
        <img
          class="modal-link-amazon-icon"
          src=${$}
          alt="Amazon product link"
          width="62"
          height="19"/></a>
        <a
          class="modal-buy-link"
          href=${o.buy_links[1].url}
          target="_blank">
        <img
          class="modal-link-apple-icon"
          src=${q}
          alt="Apple-book product link"
          width="33"
          height="32"/></a></div></div></div>
        <div class="button-toggle-wrapper">
          <button class="add-remove-button" type="button">${L(o)?u:m}</button>
          <p class="modal-text make-visible">${L(o)?x:T}</p>
        </div></div>`}async function y(t){if(t.target.dataset.action==="open-modal"&&window.innerWidth>768||t.target!==t.currentTarget&&window.innerWidth<=768){const e=await j(t),o=R.create(e,{onClose:J()});U(o),o.show(H),document.addEventListener("keydown",a=>{a.key==="Escape"&&o.close()})}else return}function H(t){g(),document.body.classList.add("scroll-ban");const e=t.element().querySelector(".modal-button-close"),o=t.element().querySelector(".add-remove-button");e.addEventListener("click",()=>t.close()),o.addEventListener("click",P),window.addEventListener("resize",g)}function J(){return()=>{document.body.classList.remove("scroll-ban"),window.removeEventListener("resize",g)}}function P(t){t.currentTarget.textContent===m?(w(t,p),t.currentTarget.textContent=u,t.currentTarget.nextElementSibling.textContent=x):t.currentTarget.textContent===u&&(w(t,p),t.currentTarget.textContent=m,t.currentTarget.nextElementSibling.textContent=T)}function g(){const t=document.querySelector(".basicLightbox"),e=document.querySelector(".modal-container");window.innerHeight<e.offsetHeight?t.classList.add("lightbox-scroll"):t.classList.remove("lightbox-scroll")}function U(t){const e={container:t.element().querySelector(".modal-container").classList,closeIcon:t.element().querySelector(".modal-icon-close").classList,bookTitle:t.element().querySelector(".modal-book-title").classList,desc:t.element().querySelector(".modal-book-desc").classList,amazonIcon:t.element().querySelector(".modal-link-amazon-icon").classList,appleIcon:t.element().querySelector(".modal-link-apple-icon").classList,addRemoveButton:t.element().querySelector(".add-remove-button").classList};n.checkbox.checked?(e.container.add("modal-container-dark-theme"),e.closeIcon.add("modal-icon-close-dark-theme"),e.bookTitle.add("modal-text-dark-theme"),e.desc.add("modal-text-dark-theme"),e.amazonIcon.add("modal-icon-amazon-dark-theme"),e.appleIcon.add("modal-icon-apple-dark-theme"),e.addRemoveButton.add("modal-text-dark-theme")):(e.container.remove("modal-container-dark-theme"),e.closeIcon.remove("modal-icon-close-dark-theme"),e.bookTitle.remove("modal-text-dark-theme"),e.desc.remove("modal-text-dark-theme"),e.amazonIcon.remove("modal-icon-amazon-dark-theme"),e.appleIcon.remove("modal-icon-apple-dark-theme"),e.addRemoveButton.remove("modal-text-dark-theme"))}function Y(t){return t.map(e=>{const o=e.list_name.split(" ");o[o.length-1]=`<span>${o[o.length-1]}</span>`;const a=`<h2 class="category-title">${o.join(" ")}</h2>`,s=b(e.books,f),c=_("see-more-button","See more",e.list_name);return a+s+c}).join("")}async function I(){const t=await l(d.topbooks),e=Y(t);i(n.mainCatWrap,e,y)}G();n.catList.addEventListener("click",V);async function G(){const t=await l(d.list),e=K(t);i(n.catList,e)}function K(t){const e='<li class="sidebar-category-item"><p class="sidebar-category-text make-blue">All categories</p></li>',o=t.map(s=>`<li class="sidebar-category-item" data-category="${s.list_name}"><p class="sidebar-category-text" data-category="${s.list_name}">${s.list_name}</p></li>`).join("");return e+o}function S(t){t.target.nodeName==="LI"?(t.target.parentElement.querySelectorAll(".sidebar-category-text").forEach(o=>{o.classList.remove("make-blue")}),t.target.firstElementChild.classList.add("make-blue")):t.target.nodeName==="P"&&(t.target.parentElement.parentElement.querySelectorAll(".sidebar-category-text").forEach(o=>{o.classList.remove("make-blue")}),t.target.classList.add("make-blue"))}async function V(t){if(t.target===t.currentTarget)return;if(!t.target.dataset.category){n.mainTitle.innerHTML="Best Sellers <span>Books</span>",S(t),I();return}S(t),D(n.mainCatWrap);const e=t.target.dataset.category.split(" ");e[e.length-1]=`<span>${e[e.length-1]}</span>`,n.mainTitle.innerHTML=e.join(" ");const o=await l(d.category,t.target.dataset.category),a=b(o,f);i(n.mainCatWrap,a,y),document.querySelectorAll(".main-category-item").forEach(c=>C(c))}const k=document.querySelector(".button-up"),Q=document.querySelector(".header-container");k.addEventListener("click",Z);window.addEventListener("scroll",X);function X(){const t=window.pageYOffset,e=document.documentElement.clientHeight;t>e?k.classList.add("button-up--show"):k.classList.remove("button-up--show")}function Z(){window.pageYOffset>0&&(window.scrollBy(),setTimeout(()=>{Q.scrollIntoView({block:"end",behavior:"smooth"})},250))}const h="mailing-list",B="input-last-value",r=document.querySelector(".footer-form");function tt(t,e){let o;return function(...a){clearTimeout(o),o=setTimeout(()=>{t.apply(this,a)},e)}}const et=tt(function(){const t=r.elements.email.value;A(B,t)},500);r.addEventListener("input",et);r.addEventListener("submit",t=>{if(t.preventDefault(),r.elements.email.value.trim()===""){N.show({message:"Введіть e-mail",messageColor:"#FFFFFF",backgroundColor:"#59A10D",position:"topRight"});return}const o=v(h)||[];o.push(r.elements.email.value),A(h,o),r.reset()});function v(t){const e=localStorage.getItem(t);if(console.log(e),!!e)try{return JSON.parse(e)}catch{return e}}function A(t,e){const o=JSON.stringify(e);localStorage.setItem(t,o)}function ot(){const t=v(B)||"";r.elements.email.value=t}ot();v(h);W();z("header-nav-link-home");I();n.mainCatWrap.addEventListener("click",at);async function at(t){if(!t.target.dataset.category)return;const e=t.target.dataset.category.split(" ");e[e.length-1]=`<span>${e[e.length-1]}</span>`,n.mainTitle.innerHTML=e.join(" ");const o=await l(d.category,t.target.dataset.category),a=b(o,f);i(n.mainCatWrap,a,y),document.querySelectorAll(".main-category-item").forEach(c=>C(c))}
//# sourceMappingURL=commonHelpers.js.map
